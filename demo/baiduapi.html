<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml">  
<head>  
    <title>World Map Baidu_API</title>  
    <!--css-->  
    <style type="text/css">  
        body { margin: 0; font-family: "Helvetica,Arial,FreeSans"; color: #000000; font-size: 12px; }  
        .demo_main { padding: 20px; padding-top: 10px; }  
        .demo_title { padding: 10px; margin-bottom: 10px; background-color: #D3D8E0; border: solid 1px gray; }  
        .demo_content { padding: 10px; margin-bottom: 10px; border: solid 1px gray; }  
        fieldset { border: 1px solid gray; }  
    </style>  
    <!--javascript-->  
    <script src="http://www.w3school.com.cn/jquery/jquery.js" type="text/javascript"></script>  
</head>  
<body>  
    <div class="demo_main">  
        <fieldset class="demo_title">  
            VE450_Team 28
        </fieldset>  
        <fieldset class="demo_content">  
            <div style="min-height: 900px; width: 100%;" id="map">  
            </div>  
            <script type="text/javascript">  
                var markerArr1 = [  
                    { title: "position 1", point: "113.264531,23.157003"},  
                    { title: "position 2", point: "113.330934,23.113401"},  
                    { title: "position 3", point: "113.312213,23.147267"},  
                    { title: "position 4", point: "113.372867,23.134274"}  
                ];  

                var markerArr2 = [  
                    { title: "position 1", point: "113.264531,23.157003"},  
                    { title: "position 2", point: "103.330934,33.113401"},  
                    { title: "position 3", point: "103.312213,33.147267"},  
                    { title: "position 4", point: "103.372867,33.134274"}  
                ];  

 

















  
                var map; //Map实例  
                function map_init() {  
                    map = new BMap.Map("map");  
                    //第1步：设置地图中心点，广州市  
                    var point = new BMap.Point(113.312213, 23.147267);  
                    //第2步：初始化地图,设置中心点坐标和地图级别。  
                    map.centerAndZoom(point, 7);  
                    //第3步：启用滚轮放大缩小  
                    map.enableScrollWheelZoom(true);  
                    //第4步：向地图中添加缩放控件  
                    var ctrlNav = new window.BMap.NavigationControl({  
                        anchor: BMAP_ANCHOR_TOP_LEFT,  
                        type: BMAP_NAVIGATION_CONTROL_LARGE  
                    });  
                    map.addControl(ctrlNav);  
                    //第5步：向地图中添加缩略图控件  
                    var ctrlOve = new window.BMap.OverviewMapControl({  
                        anchor: BMAP_ANCHOR_BOTTOM_RIGHT,  
                        isOpen: 1  
                    });  
                    map.addControl(ctrlOve);  
  
                    //第6步：向地图中添加比例尺控件  
                    var ctrlSca = new window.BMap.ScaleControl({  
                        anchor: BMAP_ANCHOR_BOTTOM_LEFT  
                    });  
                    map.addControl(ctrlSca);  

 


  
                    //第7步：绘制点    
                    for (var i = 0; i < markerArr1.length; i++) {  
                        var p0 = markerArr1[i].point.split(",")[0];  
                        var p1 = markerArr1[i].point.split(",")[1];  
                        var maker = addMarker1(new window.BMap.Point(p0, p1), i);  
                        addInfoWindow(maker, markerArr1[i], i);   
                    }  



                    for (var i = 0; i < markerArr2.length; i++) {  
                        var p0 = markerArr2[i].point.split(",")[0];  
                        var p1 = markerArr2[i].point.split(",")[1];  
                        var maker = addMarker2(new window.BMap.Point(p0, p1), i);  
                        addInfoWindow(maker, markerArr2[i], i);   
                    }  
                }  






  
                // 添加标注  
                function addMarker1(point, index) {  
                    var myIcon = new BMap.Icon('3.jpg',  
                        new BMap.Size(42, 42), {  
                            //offset: new BMap.Size(5, 5),  
                            //imageOffset: new BMap.Size(-20, -20)  
                        });  
                    var marker = new BMap.Marker(point, { icon: myIcon });  
                    map.addOverlay(marker);  
                    return marker;  
                }  
 
  
                // 添加标注  
                function addMarker2(point, index) {  
                    var myIcon = new BMap.Icon('2.jpg',  
                        new BMap.Size(50, 50), {  
                            //offset: new BMap.Size(5, 5),  
                            //imageOffset: new BMap.Size(-20, -20)  
                        });  
                    var marker = new BMap.Marker(point, { icon: myIcon });  
                    map.addOverlay(marker);  
                    return marker;  
                } 









  
                // 添加信息窗口  
                
                function addInfoWindow(marker, poi) {  
                    //pop弹窗标题  
                    var title = '<div style="font-weight:bold;color:#CE5521;font-size:14px">' + poi.title + '</div>';  
                    //pop弹窗信息  
                    var html = [];  
                    html.push('<table cellspacing="0" style="table-layout:fixed;width:100%;font:12px arial,simsun,sans-serif"><tbody>');  
                    //html.push('<tr>');  
                    //html.push('<td style="vertical-align:top;line-height:16px;width:38px;white-space:nowrap;word-break:keep-all">地址:</td>');  
                    //html.push('<td style="vertical-align:top;line-height:16px">' + poi.address + ' </td>');  
                    //html.push('</tr>');  
                    //html.push('</tbody></table>');  
                    var infoWindow = new BMap.InfoWindow(html.join(""), { title: title, width: 200 });  
  
                    var openInfoWinFun = function (poi) {  
                        var polyline = new BMap.Polyline([    
                           new BMap.Point(113.312213,23.147267),    
                           new BMap.Point(113.330934,23.113401),
                           new BMap.Point(113.372867,23.134274),  
                         ],    
                         {strokeColor:"blue", strokeWeight:6, strokeOpacity:0.5}    
                        );  
                        map.addOverlay(polyline); 
                        map.centerAndZoom(poi.point, 5); 
                        marker.openInfoWindow(infoWindow); 
                    };  
                    marker.addEventListener("click", openInfoWinFun);  
                    return openInfoWinFun;  
                }


                
  
                //异步调用百度js  
                function map_load() {  
                    var load = document.createElement("script");  
                    load.src = "http://api.map.baidu.com/api?v=1.4&callback=map_init";  
                    document.body.appendChild(load);  
                }  
                window.onload = map_load;  
            </script>  
        </fieldset>  
    </div>  
</body>  
</html>  